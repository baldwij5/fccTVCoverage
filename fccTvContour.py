import pandas as pd
import json
import os
import csv
import numpy as np

colNames = tuple(['application_id', 'service', 'lms_application_id', 'dts_site_number', 'transmitter_site', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '50', '51', '52', '53', '54', '55', '56', '57', '58', '59', '60', '61', '62', '63', '64', '65', '66', '67', '68', '69', '70', '71', '72', '73', '74', '75', '76', '77', '78', '79', '80', '81', '82', '83', '84', '85', '86', '87', '88', '89', '90', '91', '92', '93', '94', '95', '96', '97', '98', '99', '100', '101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '111', '112', '113', '114', '115', '116', '117', '118', '119', '120', '121', '122', '123', '124', '125', '126', '127', '128', '129', '130', '131', '132', '133', '134', '135', '136', '137', '138', '139', '140', '141', '142', '143', '144', '145', '146', '147', '148', '149', '150', '151', '152', '153', '154', '155', '156', '157', '158', '159', '160', '161', '162', '163', '164', '165', '166', '167', '168', '169', '170', '171', '172', '173', '174', '175', '176', '177', '178', '179', '180',
                  '181', '182', '183', '184', '185', '186', '187', '188', '189', '190', '191', '192', '193', '194', '195', '196', '197', '198', '199', '200', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '211', '212', '213', '214', '215', '216', '217', '218', '219', '220', '221', '222', '223', '224', '225', '226', '227', '228', '229', '230', '231', '232', '233', '234', '235', '236', '237', '238', '239', '240', '241', '242', '243', '244', '245', '246', '247', '248', '249', '250', '251', '252', '253', '254', '255', '256', '257', '258', '259', '260', '261', '262', '263', '264', '265', '266', '267', '268', '269', '270', '271', '272', '273', '274', '275', '276', '277', '278', '279', '280', '281', '282', '283', '284', '285', '286', '287', '288', '289', '290', '291', '292', '293', '294', '295', '296', '297', '298', '299', '300', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '311', '312', '313', '314', '315', '316', '317', '318', '319', '320', '321', '322', '323', '324', '325', '326', '327', '328', '329', '330', '331', '332', '333', '334', '335', '336', '337', '338', '339', '340', '341', '342', '343', '344', '345', '346', '347', '348', '349', '350', '351', '352', '353', '354', '355', '356', '357', '358', '359', '^'])

colNames_2 = ['application_id', 'service', 'lms_application_id', 'dts_site_number', 'transmitter_site', '_0', '_1', '_2', '_3', '_4', '_5', '_6', '_7', '_8', '_9', '_10', '_11', '_12', '_13', '_14', '_15', '_16', '_17', '_18', '_19', '_20', '_21', '_22', '_23', '_24', '_25', '_26', '_27', '_28', '_29', '_30', '_31', '_32', '_33', '_34', '_35', '_36', '_37', '_38', '_39', '_40', '_41', '_42', '_43', '_44', '_45', '_46', '_47', '_48', '_49', '_50', '_51', '_52', '_53', '_54', '_55', '_56', '_57', '_58', '_59', '_60', '_61', '_62', '_63', '_64', '_65', '_66', '_67', '_68', '_69', '_70', '_71', '_72', '_73', '_74', '_75', '_76', '_77', '_78', '_79', '_80', '_81', '_82', '_83', '_84', '_85', '_86', '_87', '_88', '_89', '_90', '_91', '_92', '_93', '_94', '_95', '_96', '_97', '_98', '_99', '_100', '_101', '_102', '_103', '_104', '_105', '_106', '_107', '_108', '_109', '_110', '_111', '_112', '_113', '_114', '_115', '_116', '_117', '_118', '_119', '_120', '_121', '_122', '_123', '_124', '_125', '_126', '_127', '_128', '_129', '_130', '_131', '_132', '_133', '_134', '_135', '_136', '_137', '_138', '_139', '_140', '_141', '_142', '_143', '_144', '_145', '_146', '_147', '_148', '_149', '_150', '_151', '_152', '_153', '_154', '_155', '_156', '_157', '_158', '_159', '_160', '_161', '_162', '_163', '_164', '_165', '_166', '_167', '_168', '_169', '_170', '_171', '_172', '_173', '_174', '_175', '_176', '_177', '_178', '_179', '_180',
              '_181', '_182', '_183', '_184', '_185', '_186', '_187', '_188', '_189', '_190', '_191', '_192', '_193', '_194', '_195', '_196', '_197', '_198', '_199', '_200', '_201', '_202', '_203', '_204', '_205', '_206', '_207', '_208', '_209', '_210', '_211', '_212', '_213', '_214', '_215', '_216', '_217', '_218', '_219', '_220', '_221', '_222', '_223', '_224', '_225', '_226', '_227', '_228', '_229', '_230', '_231', '_232', '_233', '_234', '_235', '_236', '_237', '_238', '_239', '_240', '_241', '_242', '_243', '_244', '_245', '_246', '_247', '_248', '_249', '_250', '_251', '_252', '_253', '_254', '_255', '_256', '_257', '_258', '_259', '_260', '_261', '_262', '_263', '_264', '_265', '_266', '_267', '_268', '_269', '_270', '_271', '_272', '_273', '_274', '_275', '_276', '_277', '_278', '_279', '_280', '_281', '_282', '_283', '_284', '_285', '_286', '_287', '_288', '_289', '_290', '_291', '_292', '_293', '_294', '_295', '_296', '_297', '_298', '_299', '_300', '_301', '_302', '_303', '_304', '_305', '_306', '_307', '_308', '_309', '_310', '_311', '_312', '_313', '_314', '_315', '_316', '_317', '_318', '_319', '_320', '_321', '_322', '_323', '_324', '_325', '_326', '_327', '_328', '_329', '_330', '_331', '_332', '_333', '_334', '_335', '_336', '_337', '_338', '_339', '_340', '_341', '_342', '_343', '_344', '_345', '_346', '_347', '_348', '_349', '_350', '_351', '_352', '_353', '_354', '_355', '_356', '_357', '_358', '_359', '^']

df = pd.read_csv(
    r'C:\\Users\\jackb\\Documents\\General Geospatial Data\\fcc\\TV_service_contour_current\\TV_service_contour_current.txt', delimiter='|')

# print(df.head())

# df_dict = df.to_dict('records')

# for key in df_dict:
#     print(key['service'])

# print(df_dict.head())

# f = open(r'C:\\Users\\jackb\\Documents\\General Geospatial Data\\fcc\\TV_service_contour_current\\TV_service_contour_current_1.csv', 'wb')
# w = csv.DictWriter(f, df_dict.keys())
# w.writerows(df_dict)
# f.close()

# df_dict.to_csv(
#     r'C:\\Users\\jackb\\Documents\\General Geospatial Data\\fcc\\TV_service_contour_current\\TV_service_contour_current.csv', index=True)

df_1 = pd.read_csv(
    r'C:\\Users\\jackb\\Documents\\General Geospatial Data\\fcc\\TV_service_contour_current\\TV_service_contour_current.csv', names=colNames, header=None)

print(df_1.head())

# df_2 = (df_1.melt(id_vars=["application_id"], value_vars=["_0", '_1', '_2'], value_name="_")
#         .drop('variable', axis=1)
#         .replace('', np.nan,)
#         .dropna()
#         .sort_values('application_id')
#         )


# df_2 = df_1.replace('', np.nan).set_index(
#     'application_id').stack().reset_index(name='_').drop('level_1', 1)

# df_2 = df_1.replace('', np.nan).set_index(
#     'application_id').stack().reset_index(name='_')

# df_2 = pd.melt(df, id_vars=['application_id'],
#                value_vars=[('service', 'transmitter_site')])

df_trans = df[['application_id', 'transmitter_site']]

df_trans.to_csv(
    r'C:\\Users\\jackb\\Documents\\General Geospatial Data\\fcc\\TV_service_contour_current\\TV_service_transmitter_station.csv', index=True)

df_azimuth = df[['application_id', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '50', '51', '52', '53', '54', '55', '56', '57', '58', '59', '60', '61', '62', '63', '64', '65', '66', '67', '68', '69', '70', '71', '72', '73', '74', '75', '76', '77', '78', '79', '80', '81', '82', '83', '84', '85', '86', '87', '88', '89', '90', '91', '92', '93', '94', '95', '96', '97', '98', '99', '100', '101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '111', '112', '113', '114', '115', '116', '117', '118', '119', '120', '121', '122', '123', '124', '125', '126', '127', '128', '129', '130', '131', '132', '133', '134', '135', '136', '137', '138', '139', '140', '141', '142', '143', '144', '145', '146', '147', '148', '149', '150', '151', '152', '153', '154', '155', '156', '157', '158', '159', '160', '161', '162', '163', '164', '165', '166', '167', '168', '169', '170', '171', '172', '173', '174', '175', '176', '177', '178', '179', '180',
                 '181', '182', '183', '184', '185', '186', '187', '188', '189', '190', '191', '192', '193', '194', '195', '196', '197', '198', '199', '200', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '211', '212', '213', '214', '215', '216', '217', '218', '219', '220', '221', '222', '223', '224', '225', '226', '227', '228', '229', '230', '231', '232', '233', '234', '235', '236', '237', '238', '239', '240', '241', '242', '243', '244', '245', '246', '247', '248', '249', '250', '251', '252', '253', '254', '255', '256', '257', '258', '259', '260', '261', '262', '263', '264', '265', '266', '267', '268', '269', '270', '271', '272', '273', '274', '275', '276', '277', '278', '279', '280', '281', '282', '283', '284', '285', '286', '287', '288', '289', '290', '291', '292', '293', '294', '295', '296', '297', '298', '299', '300', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '311', '312', '313', '314', '315', '316', '317', '318', '319', '320', '321', '322', '323', '324', '325', '326', '327', '328', '329', '330', '331', '332', '333', '334', '335', '336', '337', '338', '339', '340', '341', '342', '343', '344', '345', '346', '347', '348', '349', '350', '351', '352', '353', '354', '355', '356', '357', '358', '359']]

print(df_azimuth.head())

df_2 = df_azimuth.set_index('application_id').stack()


# df2 = df_2.set_axis(['application_id', 'index_old',
#                      'longitude', 'latitude'], axis=1, inplace=False)
# df2 = df_2 = [['application_id', 'longitude', 'latitude']]

print(df_2.head())

df_2.to_csv(
    r'C:\\Users\\jackb\\Documents\\General Geospatial Data\\fcc\\TV_service_contour_current\\TV_service_contour_current_3.csv', index=True)


colnames = ['application_id', 'index_old', 'coordinates']

df_3 = pd.read_csv(
    r'C:\\Users\\jackb\\Documents\\General Geospatial Data\\fcc\\TV_service_contour_current\\TV_service_contour_current_3.csv', names=colnames, header=None)

df_3 = df_3[['application_id', 'coordinates']]

df_3[['latitiude', 'longitude']
     ] = df_3['coordinates'].str.split(',', expand=True)

df_3.to_csv(
    r'C:\\Users\\jackb\\Documents\\General Geospatial Data\\fcc\\TV_service_contour_current\\TV_service_contour_current_Final.csv', index=False)

# df_3 = pd.read_csv(
#     r'C:\\Users\\jackb\\Documents\\General Geospatial Data\\fcc\\TV_service_contour_current\\TV_service_contour_current_3.csv', sep=' ,')

# df_3.to_csv(
#     r'C:\\Users\\jackb\\Documents\\General Geospatial Data\\fcc\\TV_service_contour_current\\TV_service_contour_current_4.csv', index=True)
